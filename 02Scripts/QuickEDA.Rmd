---
title: "Quick Data Visualization"
author: "Renata"
date: "2024-07-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Set-up

```{r read in data}

ChicagoData <- read.csv("./ChicagoSegmentData.csv")
DurhamData <- read.csv("./DurhamSegmentData.csv")


```



###Look at Census data

Change Median Household Income
Median Household Income

Change Percent White non-HL
Percent White non-HL

Avg Percent Renter

Avg Percent Recent Movers

SVI

Construction

% commercial

% residential

```{r Census data}

##case study areas - Chicago
Cgr1 <- c(57, 16)
Cgr2 <- c(244, 49)
ChiCaseStudyData1 <- ChicagoData[ChicagoData$Segment %in% Cgr1,] #blues
ChiCaseStudyData2 <- ChicagoData[ChicagoData$Segment %in% Cgr2,] #reds

#####case study areas - Durham
Dgr1 <- c("M22", "K18") #greens
Dgr2 <- c("O21", "M19") #purples
Dgr3 <- c("R21", "R24") #yellows

DurCaseStudyData1 <- DurhamData[DurhamData$Segment %in% Dgr1,]
DurCaseStudyData2 <- DurhamData[DurhamData$Segment %in% Dgr2,]
DurCaseStudyData3 <- DurhamData[DurhamData$Segment %in% Dgr3,]

#############Median Household Income
hist(ChicagoData$MedHouseInc21, breaks = 15, main="Chicago Median Household Income 2021")
abline(v=ChiCaseStudyData1$MedHouseInc21[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$MedHouseInc21[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$MedHouseInc21[1], col="coral", lwd=3) #244
abline(v=ChiCaseStudyData2$MedHouseInc21[2], col="red", lwd=3) #49

hist(ChicagoData$Change_MedHHI, breaks = 10, main="Chicago Change Median Household Income")
abline(v=ChiCaseStudyData1$Change_MedHHI[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$Change_MedHHI[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$Change_MedHHI[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$Change_MedHHI[2], col="red", lwd=3)

hist(DurhamData$MedHouseInc21, breaks = 20, main="Durham Median Household Income 2021")
# abline(v=DurCaseStudyData1$MedHouseInc21[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$MedHouseInc21[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$MedHouseInc21[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$MedHouseInc21[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$MedHouseInc21[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$MedHouseInc21[2], col="goldenrod3", lwd=3)

hist(DurhamData$Change_MedHHI, breaks = 10, main="Durham Change Median Household Income")
# abline(v=DurCaseStudyData1$Change_MedHHI[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$Change_MedHHI[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$Change_MedHHI[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$Change_MedHHI[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$Change_MedHHI[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$Change_MedHHI[2], col="goldenrod3", lwd=3)


#############Percent White non-HL
hist(ChicagoData$PercWhiteNonHL21, breaks = 15, main="Chicago Percent White 2021")
abline(v=ChiCaseStudyData1$PercWhiteNonHL21[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$PercWhiteNonHL21[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$PercWhiteNonHL21[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$PercWhiteNonHL21[2], col="red", lwd=3)
hist(ChicagoData$Change_PWnHL, breaks = 10, main="Chicago Change Percent White")
abline(v=ChiCaseStudyData1$Change_PWnHL[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$Change_PWnHL[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$Change_PWnHL[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$Change_PWnHL[2], col="red", lwd=3)


hist(DurhamData$PercWhiteNonHL21, breaks = 20, main="Durham Percent White")
# abline(v=DurCaseStudyData1$PercWhiteNonHL21[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$PercWhiteNonHL21[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$PercWhiteNonHL21[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$PercWhiteNonHL21[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$PercWhiteNonHL21[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$PercWhiteNonHL21[2], col="goldenrod3", lwd=3)
hist(DurhamData$Change_PWnHL, breaks = 10, main="Durham Change Percent White")
# abline(v=DurCaseStudyData1$Change_PWnHL[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$Change_PWnHL[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$Change_PWnHL[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$Change_PWnHL[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$Change_PWnHL[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$Change_PWnHL[2], col="goldenrod3", lwd=3)


###################Average Percent Renter
hist(ChicagoData$Avg_PRent, breaks = 10, main="Chicago Avg Percent Renter")
abline(v=ChiCaseStudyData1$Avg_PRent[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$Avg_PRent[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$Avg_PRent[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$Avg_PRent[2], col="red", lwd=3)

hist(DurhamData$Avg_PRent, breaks = 10, main="Durham Avg Percent Renter")
# abline(v=DurCaseStudyData1$Avg_PRent[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$Avg_PRent[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$Avg_PRent[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$Avg_PRent[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$Avg_PRent[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$Avg_PRent[2], col="goldenrod3", lwd=3)


####################Average Recent Movers
hist(ChicagoData$Avg_Rmov, breaks = 10, main="Chicago Avg Percent Recent Movers")
abline(v=ChiCaseStudyData1$Avg_Rmov[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$Avg_Rmov[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$Avg_Rmov[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$Avg_Rmov[2], col="red", lwd=3)

hist(DurhamData$Avg_Rmov, breaks = 10, main="Durham Avg Percent Recent Movers")
# abline(v=DurCaseStudyData1$Avg_Rmov[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$Avg_Rmov[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$Avg_Rmov[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$Avg_Rmov[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$Avg_Rmov[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$Avg_Rmov[2], col="goldenrod3", lwd=3)


######################SVI
hist(ChicagoData$SVI, breaks = 10, main="Chicago SVI")
abline(v=ChiCaseStudyData1$SVI[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$SVI[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$SVI[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$SVI[2], col="red", lwd=3)

hist(DurhamData$SVI, breaks = 10, main="Durham SVI")
# abline(v=DurCaseStudyData1$SVI[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$SVI[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$SVI[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$SVI[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$SVI[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$SVI[2], col="goldenrod3", lwd=3)


####################Construction
hist(ChicagoData$AllConst_since11, breaks = 10, main="Chicago All Construction")
abline(v=ChiCaseStudyData1$AllConst_since11[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$AllConst_since11[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$AllConst_since11[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$AllConst_since11[2], col="red", lwd=3)

hist(DurhamData$NumConst_since11, breaks = 10, main="Durham Construction since 2011")
# abline(v=DurCaseStudyData1$NumConst_since11[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$NumConst_since11[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$NumConst_since11[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$NumConst_since11[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$NumConst_since11[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$NumConst_since11[2], col="goldenrod3", lwd=3)
hist(DurhamData$NumReno_since11, breaks = 10, main="Durham Renovation since 2011")
# abline(v=DurCaseStudyData1$NumReno_since11[1], col="springgreen", lwd=3)
# abline(v=DurCaseStudyData1$NumReno_since11[2], col="green4", lwd=3)
abline(v=DurCaseStudyData2$NumReno_since11[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$NumReno_since11[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$NumReno_since11[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$NumReno_since11[2], col="goldenrod3", lwd=3)

```

##Notes

Chicago:
* blues - generally more similar in income and percent white in 2021, with different trajectories to get there and separation in avg renters and avg recent movers
  - light blue has had more change in income and percent white but has lower rentership and recent movers
* reds - have a bit more of a gap in 2021 in income, but the change is more similar, similar both percent white and change. Pretty big difference in average recent movers, and the SVI is super similar

Makes me consider focusing on the reds, being able to look at the contrast with recent movers and  construction?


Durham
* only focusing on the segments with 10+ trees
* get rid of Q21 because it is almost entirely commercialand O19 and P21 because they are mostly ot residential

Greens
* greens look similar in 2021 except for percent white, which is both different and has changed in opposite directions
* they both don't have a ton of recent movers
* seemingly identical construction and renovations
* the big contrast would be percent white and the change in income (light green had a bigger jump up), which seems hard to really dive into

For K18, all the trees are b a median, which messes with things

Purples
* similar median income in 2021, but light purple jumped up more than dark purple
* similar percent white and moderate increase for both
similar renter, light purple has slightly more recent movers
* light purple has a lot more construction and especially renovations

Seems like a solid candidate, but the light purple one seems to look good (M19) vs the dark purple (O21)

Yellows
* both relatively low income in 2021, but light yellow jumped up quite a bit
* neither particularly white, but both increasing (light yellow more)
* similar renters, dark yellow has more recent movers
* light yellow has more construction and renovations

Would be good if you are intersted in the contrast between recent movers and everything else

light yellow has worse discoloration but lower dieback and CS. This contrast seems to be the exact opposite of what the model parameter estimates are telling us it should be....


##look at tree health outcomes

```{r tree health outcomes}

##case study areas - Chicago
Cgr1 <- c(57, 16)
Cgr2 <- c(244, 49)
ChiCaseStudyData1 <- ChicagoData[ChicagoData$Segment %in% Cgr1,] #blues
ChiCaseStudyData2 <- ChicagoData[ChicagoData$Segment %in% Cgr2,] #reds

#####case study areas - Durham
#Dgr1 <- c("M22", "K18") #greens - ignore, trees are in the median
Dgr2 <- c("O21", "M19") #purples
Dgr3 <- c("R21", "R24") #yellows

#DurCaseStudyData1 <- DurhamData[DurhamData$Segment %in% Dgr1,]
DurCaseStudyData2 <- DurhamData[DurhamData$Segment %in% Dgr2,]
DurCaseStudyData3 <- DurhamData[DurhamData$Segment %in% Dgr3,]


########################Discoloration
hist(ChicagoData$PercDisc3o4, breaks = 10, main="Chicago High Discoloration")
abline(v=ChiCaseStudyData1$PercDisc3o4[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$PercDisc3o4[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$PercDisc3o4[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$PercDisc3o4[2], col="red", lwd=3)

hist(DurhamData$PercDisc3o4, breaks = 10, main="Durham High Discoloration")
abline(v=DurCaseStudyData2$PercDisc3o4[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$PercDisc3o4[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$PercDisc3o4[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$PercDisc3o4[2], col="goldenrod3", lwd=3)


###########################Dieback
hist(ChicagoData$PercDBK5, breaks = 10, main="Chicago High Dieback")
abline(v=ChiCaseStudyData1$PercDBK5[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$PercDBK5[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$PercDBK5[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$PercDBK5[2], col="red", lwd=3)

hist(DurhamData$PercDBK5, breaks = 10, main="Durham High Dieback")
abline(v=DurCaseStudyData2$PercDBK5[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$PercDBK5[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$PercDBK5[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$PercDBK5[2], col="goldenrod3", lwd=3)





###########################Crown Stress
hist(ChicagoData$PercCS4o5, breaks = 10, main="Chicago High Crown Stress")
abline(v=ChiCaseStudyData1$PercCS4o5[1], col="cyan", lwd=3)
abline(v=ChiCaseStudyData1$PercCS4o5[2], col="blue", lwd=3)
abline(v=ChiCaseStudyData2$PercCS4o5[1], col="coral", lwd=3)
abline(v=ChiCaseStudyData2$PercCS4o5[2], col="red", lwd=3)

hist(DurhamData$PercCS4o5, breaks = 10, main="Durham High Crown Stress")
abline(v=DurCaseStudyData2$PercCS4o5[1], col="darkorchid1", lwd=3)
abline(v=DurCaseStudyData2$PercCS4o5[2], col="darkorchid4", lwd=3)
abline(v=DurCaseStudyData3$PercCS4o5[1], col="gold", lwd=3)
abline(v=DurCaseStudyData3$PercCS4o5[2], col="goldenrod3", lwd=3)
```


Comparing to expected
* for Chicago, the blues make sense as far as I can tell
* for Durham, the yellows should make sense but they are literally the exact opposite of what the model indicates...